<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>R base的內建pipeline | 算是紀錄一下</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
    
<link href="https://fonts.googleapis.com/css?family=Noto+Serif+TC&display=swap&subset=chinese-traditional" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Ubuntu&display=swap" rel="stylesheet">
<link href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" rel="stylesheet">


  </head>

  <body>
    <nav>
    <ul class="menu">
      
      <li><a href="/">Home</a></li>
      
      <li><a href="/about/">About</a></li>
      
      <li><a href="/categories/">Categories</a></li>
      
      <li><a href="/tags/">Tags</a></li>
      
    </ul>
    <hr/>
    </nav>

<div class="article-meta">
<h1><span class="title">R base的內建pipeline</span></h1>
<h2 class="author">deadfate-sky</h2>
<h2 class="date">2020/12/12</h2>
</div>

<main>

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>
<link href="/rmarkdown-libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<script src="/rmarkdown-libs/anchor-sections/anchor-sections.js"></script>


<p>今天意外看到R core team也有在開發它們自己內建的pipeline，嚇得我趕緊下載了R的dev版本。R base版本的pipeline，長成<code>|&gt;</code>這附模樣，可以看到像下面那篇twitter的例子。[^add html]</p>
<blockquote class="twitter-tweet">
<p lang="en" dir="ltr">
<a href="https://twitter.com/hashtag/RStats?src=hash&amp;ref_src=twsrc%5Etfw">#RStats</a> community, really? It's been like 5 hours now and no one noticed the big news? 😛<a href="https://t.co/c4OXTO0WCw">https://t.co/c4OXTO0WCw</a><br><br>Thank you <a href="https://twitter.com/LukeTierney4?ref_src=twsrc%5Etfw"><span class="citation">@LukeTierney4</span></a> <a href="https://twitter.com/_lionelhenry?ref_src=twsrc%5Etfw"><span class="citation">@_lionelhenry</span></a> <a href="https://twitter.com/jimhester_?ref_src=twsrc%5Etfw"><span class="citation">@jimhester_</span></a> (who else?)<a href="https://twitter.com/hashtag/pipypipy?src=hash&amp;ref_src=twsrc%5Etfw">#pipypipy</a> <a href="https://t.co/5P9QPe1H8a">pic.twitter.com/5P9QPe1H8a</a>
</p>
— Henrik Bengtsson (<span class="citation">@henrikbengtsson</span>) <a href="https://twitter.com/henrikbengtsson/status/1334703130378788866?ref_src=twsrc%5Etfw">December 4, 2020</a>
</blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<p>裝好R-dev版本之後，我很快的找了關於<code>|&gt;</code>的help document來看看。
<img src="/img/R-pipe-doc.png" alt="R-pipeline-help" />
<img src="/img/R-pipe-ex.png" alt="R-pipeline-example" />
文檔大致上長得如此，這個內建pipe的方法，就跟熟悉的<code>%&gt;%</code>一樣，例如：</p>
<pre class="r"><code>&gt; mtcars |&gt; subset(cyl == 4) |&gt; subset(select = mpg)
&gt; 
                mpg
Datsun 710     22.8
Merc 240D      24.4
Merc 230       22.8
Fiat 128       32.4
Honda Civic    30.4
Toyota Corolla 33.9
Toyota Corona  21.5
Fiat X1-9      27.3
Porsche 914-2  26.0
Lotus Europa   30.4
Volvo 142E     21.4</code></pre>
<p>就可以得到選出來的結果，看看cyl是4的車子，它的mpg是多少。其效果跟<code>{dplyr}</code>的<code>filter()</code>、<code>select()</code>一樣，只是現在全部都能用內建的函數完成。</p>
<p>另外，它也能讓pipeline直接進到function裡面，像是下面這樣</p>
<pre class="r"><code>&gt; mtcars |&gt; subset(cyl == 4) |&gt; \(d) lm(mpg ~ disp, data = d)

Call:
lm(formula = mpg ~ disp, data = d)

Coefficients:
(Intercept)         disp  
    40.8720      -0.1351 </code></pre>
<p>把選好的data.frame放進一個可以生成model的function裡面，效果跟
<code>mtcars |&gt; subset(cyl == 4) |&gt; function(d) lm(mpg ~ disp, data = d)</code></p>
<p>一樣。</p>
<p>總結來說，R core team開發這個內建的水管，真是個酷東西。</p>
<p>[^add html]: 因為在內嵌html的時候遇到一些困難，Hugo有問題，所以附上解決方案<a href="https://stackoverflow.com/questions/63198652/hugo-shortcode-ignored-saying-raw-html-omitted" class="uri">https://stackoverflow.com/questions/63198652/hugo-shortcode-ignored-saying-raw-html-omitted</a></p>

<iframe class="LikeCoin" height="235" src="https://button.like.co/in/embed/evan19983314/button?referrer=%2f2020%2f12%2f12%2fr-base-pipeline%2f" width="100%" frameborder=0></iframe>

</main>


<p class="terms">
  
  
  Categories:
  
  <a href='/categories/programming'>programming</a>
  
  
  
  
  Tags:
  
  <a href='/tags/r'>R</a>
  
  <a href='/tags/%E4%B9%BE%E8%B2%A8'>乾貨</a>
  
  
  
</p>


  <footer>
  <script src="//yihui.name/js/math-code.js"></script>
<script async src="//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>

<script async src="//yihui.name/js/center-img.js"></script>

  <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "deadfate" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  
  <script src="//cdn.bootcss.com/highlight.js/9.18.1/highlight.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/python.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/yaml.min.js"></script>
  <script>
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  </script>
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-156464110-1"></script>
  <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-156464110-1');
  </script>
  
  <hr/>
  © <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh_TW">本站採用CC4.0授權</a> | <a href="https://github.com/deadfate-sky">Github</a>
  
  </footer>
  </body>
</html>

